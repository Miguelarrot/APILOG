CREATE DATABASE ELCONTENTO
GO

USE ELCONTENTO
GO

CREATE TABLE USUARIOS(
CARNET bigint PRIMARY KEY NOT NULL,
CLAVE VARCHAR(50) NOT NULL,
ROL INT NOT NULL,
PREGUNTA VARCHAR(50),
RESPUESTA VARCHAR(50));
GO

CREATE TABLE PERSONAS(
CARNET BIGINT PRIMARY KEY,
NOMBRE VARCHAR(30),
EDAD INT);
GO
INSERT into PERSONAS VALUES ( 
            11, ' alberto ',21 )
CREATE TABLE ESTUDIANTES(
CARNET BIGINT PRIMARY KEY,
NOTA_DEF REAL )
GO

CREATE TABLE PROFESORES(
CARNET BIGINT PRIMARY KEY,
ESPECIALIDAD VARCHAR(30))
GO

CREATE TABLE GRUPO(
CODIGO INT PRIMARY KEY,
TEMA VARCHAR(30))
GO
CREATE TABLE PERTENECEN(
CARNET BIGINT,
CODGRUPO INT,
PRIMARY KEY(CARNET,CODGRUPO))
GO

CREATE TABLE NOTAS(
IDNOTA INT,
COD_GRUP INT,
PERIODO INT,
ID_EST BIGINT,
PRIMARY KEY(IDNOTA,COD_GRUP,PERIODO, ID_EST),
NOTA REAL,
PORCENTAJE INT)
GO

CREATE TABLE PERIODO(
IDPERIODO INT PRIMARY KEY,
PERIODO INT)
GO

ALTER TABLE ESTUDIANTES ADD 
FOREIGN KEY (CARNET) REFERENCES PERSONAS(CARNET)
GO

ALTER TABLE PROFESORES ADD
FOREIGN KEY (CARNET) REFERENCES PERSONAS(CARNET)
GO

ALTER TABLE PERTENECEN ADD 
FOREIGN KEY(CODGRUPO) REFERENCES GRUPO(CODIGO)
GO
ALTER TABLE PERTENECEN ADD
FOREIGN KEY (CARNET) REFERENCES PERSONAS(CARNET)
GO

ALTER TABLE NOTAS ADD
FOREIGN KEY(ID_EST,COD_GRUP ) REFERENCES PERTENECEN(CARNET,CODGRUPO)
GO

ALTER TABLE NOTAS ADD
FOREIGN KEY(PERIODO) REFERENCES PERIODO(IDPERIODO)
GO

--PARA LOS ROLES 1. ESTUDIANTES, 2.PROFESORES, 3.ADMINISTRADOR
INSERT INTO USUARIOS VALUES
(10,'abcd123', 1, 'color', 'verde' ),
(20,'1234', 1 , 'color', 'rojo'),
(30,'artesplas12',1, 'ciudad de nacimiento', 'bogota' ),
(40, 'iloveart23',1, 'mascota', 'luna' ),
(50, 'amorporelarte',1, 'color', 'naranja'),
(60,'ema1234',1, 'ciudad de nacimiento', 'medellin'),
(70,'juana12',1, 'color', 'verde'),
(80,'vale23',1, 'color', 'rojo'),
(90,'alejo21',1, 'mascota', 'rokie'),
(100, 'iloveteach',2, 'color', 'azul'),
(200,'soyprofedearte',2, 'mascota', 'risa'),
(300, 'santiago234',2, 'color', 'negro'),
(1,'soyadmin32',3, 'color', 'azul');
GO

INSERT INTO PERSONAS VALUES
(10,'juan', 27 ),
(20,'ana',18 ),
(30,'majo',19 ),
(40,'mario', 41 ),
(50,'david', 31),
(60,'emanuel',51),
(70,'juana',55),
(80,'valentina',34),
(90,'alejandro',42),
(100,'Juan lopez', 45),
(200,'Maria torres',26),
(300,'Santiago mota',47)
GO

INSERT INTO PROFESORES VALUES
(100,'ARCILLA'),
(200,'ORIGAMI'),
(300,'ANCHETAS Y DECORAR');
GO
INSERT INTO ESTUDIANTES VALUES
(10,NULL),
(20,NULL),
(30,NULL),
(40,NULL),
(50,NULL),
(60,NULL),
(70,NULL),
(80,NULL),
(90,NULL);
GO

INSERT INTO GRUPO VALUES
(1000,'MODELADO DE ARCILLA'),
(2000,'ORIGAMI'),
(3000,'ANCHETAS');
GO

INSERT INTO PERTENECEN VALUES
(100,1000),
(200,3000),
(300,2000),
(10,1000),
(20,1000),
(30,1000),
(40,2000),
(50,3000),
(60,2000),
(70,3000),
(80,2000),
(90,3000);
GO

INSERT INTO PERIODO VALUES
(1,2024)
GO
INSERT INTO NOTAS VALUES
(1,1000,1,10,4,20),
(2,1000,1,10,3,20),
(3,1000,1,10,2,20),
(4,1000,1,10,3.3,20);
go

CREATE VIEW ESTUDIANTE AS
SELECT E.CARNET,P.CODGRUPO, PE.NOMBRE 
FROM PERTENECEN P INNER JOIN ESTUDIANTES E 
ON P.CARNET=E.CARNET INNER JOIN PERSONAS PE 
ON E.CARNET = PE.CARNET
